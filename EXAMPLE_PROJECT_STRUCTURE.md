# Django-Next Example Project Structure

This document shows the exact file structure and file names you'll have after setting up Django-Next.

## 📁 Complete Project Structure

```
my-nextjs-app/                          # Your Next.js project root
├── app/                                # Next.js App Router
│   ├── layout.tsx                      # Root layout with providers
│   ├── providers.tsx                   # React Query and Django-Next providers
│   ├── page.tsx                        # Home page
│   ├── login/
│   │   └── page.tsx                    # Login page
│   └── admin/
│       └── page.tsx                    # Protected admin page
├── lib/                                # Generated SDK and utilities
│   ├── api/                            # Generated by django-next generate
│   │   ├── types.ts                    # TypeScript interfaces for Django models
│   │   ├── api.ts                      # API client with all endpoints
│   │   ├── hooks.ts                    # React Query hooks
│   │   ├── actions.ts                  # Server Actions for forms
│   │   ├── validators.ts               # Zod schemas for validation
│   │   └── README.md                   # Auto-generated usage guide
│   └── hooks/
│       └── useApi.ts                   # Your useApi hook implementation
├── components/                         # Your React components
│   ├── LoginForm.tsx                   # Login form component
│   ├── PostList.tsx                    # Data fetching example
│   ├── FileUpload.tsx                  # File upload example
│   └── AdminPanel.tsx                  # Protected component example
├── django.config.js                    # Django-Next configuration
├── package.json                        # Dependencies
└── next.config.js                      # Next.js configuration
```

## 📝 Key File Contents

### django.config.js
```javascript
module.exports = {
  schema: "http://localhost:8000/api/schema/",
  output: "./lib/api",
  baseUrl: "http://localhost:8000",
  auth: {
    loginUrl: "/api/auth/login/",
    logoutUrl: "/api/auth/logout/",
    userUrl: "/api/auth/me/",
    refreshUrl: "/api/auth/refresh/",
  },
};
```

### app/providers.tsx
```typescript
'use client';

import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { ApiProvider, AuthProvider } from '@django-next/client';
import { ApiClient } from '../lib/api/api';
import { useState } from 'react';

export function Providers({ children }: { children: React.ReactNode }) {
  const [queryClient] = useState(() => new QueryClient());
  const [apiClient] = useState(() => new ApiClient({
    baseURL: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000',
  }));

  return (
    <QueryClientProvider client={queryClient}>
      <ApiProvider api={apiClient}>
        <AuthProvider>
          {children}
        </AuthProvider>
      </ApiProvider>
    </QueryClientProvider>
  );
}
```

### app/layout.tsx
```typescript
import { Providers } from './providers';

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body>
        <Providers>
          {children}
        </Providers>
      </body>
    </html>
  );
}
```

### lib/hooks/useApi.ts
```typescript
import { useContext } from 'react';
import { ApiContext } from '@django-next/client';
import type { ApiClient } from '../api/api';

export function useApi(): ApiClient {
  const context = useContext(ApiContext);
  if (!context) throw new Error('useApi must be used within ApiProvider');
  return context.api as ApiClient;
}

(globalThis as any).useApi = useApi;
```

### components/LoginForm.tsx
```typescript
import { useAuth } from '@django-next/client';
import { useApi_auth_login_create } from '../lib/api/hooks';

export function LoginForm() {
  const { isAuthenticated, user } = useAuth();
  
  const loginMutation = useApi_auth_login_create({
    onSuccess: () => console.log('Login successful!')
  });

  if (isAuthenticated) {
    return <div>Welcome, {user?.username}!</div>;
  }

  const handleLogin = (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    const formData = new FormData(e.currentTarget);
    
    loginMutation.mutate({
      username: formData.get('username') as string,
      password: formData.get('password') as string,
    });
  };

  return (
    <form onSubmit={handleLogin}>
      <input name="username" placeholder="Username" required />
      <input name="password" type="password" placeholder="Password" required />
      <button type="submit">Login</button>
    </form>
  );
}
```

### components/PostList.tsx
```typescript
import { useApi_posts_list } from '../lib/api/hooks';

export function PostList() {
  const { data: posts, isLoading, error } = useApi_posts_list();

  if (isLoading) return <div>Loading...</div>;
  if (error) return <div>Error: {error.message}</div>;

  return (
    <div>
      {posts?.data.results.map(post => (
        <div key={post.id}>
          <h2>{post.title}</h2>
          <p>{post.content}</p>
        </div>
      ))}
    </div>
  );
}
```

### components/AdminPanel.tsx
```typescript
import { Protected } from '@django-next/client';
import { useApi_users_list } from '../lib/api/hooks';

export function AdminPanel() {
  return (
    <Protected 
      requireAuth={true}
      requirePermission="users.view_user"
      fallback={<div>Access denied</div>}
    >
      <AdminContent />
    </Protected>
  );
}

function AdminContent() {
  const { data: users } = useApi_users_list();
  
  return (
    <div>
      <h1>Admin Panel</h1>
      <p>Users: {users?.data.count}</p>
    </div>
  );
}
```

## 🚀 Setup Commands

```bash
# 1. Install packages
npm install -g @django-next/cli
npm install @django-next/client @tanstack/react-query axios zod

# 2. Generate SDK
django-next init
django-next generate

# 3. Create the files above
# 4. Start your Next.js app
npm run dev
```

## ✅ Verification Checklist

After setup, verify these files exist:

- [ ] `django.config.js` - Configuration file
- [ ] `app/providers.tsx` - React providers
- [ ] `app/layout.tsx` - Root layout
- [ ] `lib/hooks/useApi.ts` - useApi hook
- [ ] `lib/api/types.ts` - Generated types
- [ ] `lib/api/api.ts` - Generated API client
- [ ] `lib/api/hooks.ts` - Generated React hooks
- [ ] `lib/api/actions.ts` - Generated Server Actions
- [ ] `lib/api/validators.ts` - Generated Zod schemas

If any files are missing, run `django-next generate` again.

## 🎯 Import Paths Reference

Use these exact import paths in your components:

```typescript
// Generated SDK imports
import { useApi_posts_list } from '../lib/api/hooks';
import { api_posts_createAction } from '../lib/api/actions';
import type { Post } from '../lib/api/types';

// Client package imports
import { useAuth, Protected, ApiProvider, AuthProvider } from '@django-next/client';

// Your custom hooks
import { useApi } from '../lib/hooks/useApi';
```

This structure ensures everything works together seamlessly! 🎉
